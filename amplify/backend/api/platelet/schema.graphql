type User @model {
  id: ID!
  username: String!
  contact: [Address]
  displayName: String!
  name: String
  roles: [Role]
  dateOfBirth: AWSDateTime
  vehicles: [Vehicle] @connection(keyName: "byAssignedUser", fields: ["id"])
  patch: [Patch]
  status: String!
  profilePictureURL: String
  profilePictureThumbnailURL: String
  comments: [Comment]
  group: Group @connection(name: "GroupMembers")
  tasks: [UserTasks] @connection(name: "UserTasks")
}

type Group @model {
  id: ID!
  name: String
  users: [User] @connection(name: "GroupMembers")
}

type Vehicle @model @key(name: "byAssignedUser", fields: ["assignedUserID"]) {
  id: ID!
  assignedUserID: ID
  name: String!
  manufacturer: String
  model: String
  dateOfManufacture: AWSDateTime
  dateOfRegistration: AWSDateTime
  assignedUser: User @connection(fields: ["assignedUserID"])
  comments: [Comment]
}

type Address @model {
  id: ID!
  name: String
  telephoneNumber: [String]
  mobileNumber: [String]
  emailAddress: [String]
  ward: String
  line1: String
  line2: String
  line3: String
  town: String
  county: String
  state: String
  country: String
  postcode: String
  zipcode: String
  what3words: String
  listed: Boolean
  protected: Boolean
  comments: [Comment]
}
type Deliverable @model {
  id: ID!
  type: DeliverableType
  count: Int!
  unit: DeliverableUnit
  numBoxes: Int
  comments: [Comment]
}

type UserTasks @model(queries: null) {
  id: ID!
  user: User @connection(name: "UserTasks")
  task: Task @connection(name: "TaskUsers")
}

type Task
  @model
  @key(name: "byStatus", fields: ["status"], queryField: "tasksByStatus") {
  #   @key(
  #     name: "byStatusbyGroup"
  #     fields: ["status", "group"]
  #     queryField: "tasksByStatusbyGroup"
  #   )
  id: ID!
  name: String
  createdBy: User @connection
  timeOfCall: AWSDateTime
  timePickedUp: AWSDateTime
  timeDroppedOff: AWSDateTime
  timeCancelled: AWSDateTime
  timeRejected: AWSDateTime
  requesterContact: Address
  pickupLocation: Address @connection
  dropoffLocation: Address @connection
  patch: Patch
  coordinators: [User] @connection
  riders: [UserTasks] @connection(name: "TaskUsers")
  priority: Priority
  deliverables: [Deliverable!]
  relayPrevious: Task
  relayNext: Task
  comments: [Comment!] @connection(keyName: "byParent", fields: ["id"])
  status: TaskStatus!
}

type Comment @model @key(name: "byParent", fields: ["parentID", "body"]) {
  id: ID!
  parentID: ID!
  body: String!
  author: User @connection
  publiclyVisible: Boolean
}

enum TaskStatus {
  NEW
  ACTIVE
  PICKED_UP
  DROPPED_OFF
  CANCELLED
  REJECTED
}

enum Priority {
  HIGH
  MEDIUM
  LOW
}

enum Patch {
  NORTH
  WEST
  EAST
  SOUTH
  RELIEF
  AIR_AMBULANCE
}

enum DeliverableType {
  MILK
  BLOOD
  PLATELETS
  SAMPLE
  COVID_SAMPLE
  DOCUMENTS
  EQUIPMENT
  OTHER
}

enum DeliverableUnit {
  LITRE
  MILLILITRES
  GRAMS
  COUNT
  BOX
}

enum Role {
  COORDINATOR
  RIDER
  ADMIN
}
